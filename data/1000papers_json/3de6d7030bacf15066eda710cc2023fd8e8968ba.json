{"paper_id": "3de6d7030bacf15066eda710cc2023fd8e8968ba", "metadata": {"title": "Lung Segmentation from Chest X-rays using Variational Data Imputation", "authors": [{"first": "Raghavendra", "middle": [], "last": "Selvan", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Erik", "middle": ["B"], "last": "Dam", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Sofus", "middle": [], "last": "Rischel", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Kaining", "middle": [], "last": "Sheng", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Mads", "middle": [], "last": "Nielsen", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Akshay", "middle": [], "last": "Pai", "suffix": "", "affiliation": {}, "email": ""}]}, "abstract": [{"text": "Pulmonary opacification is the inflammation in the lungs caused by many respiratory ailments, including the novel corona virus disease 2019 . Chest X-rays (CXRs) with such opacifications render regions of lungs imperceptible, making it difficult to perform automated image analysis on them. In this work, we focus on segmenting lungs from such abnormal CXRs as part of a pipeline aimed at automated risk scoring of COVID-19 from CXRs. We treat the high opacity regions as missing data and present a modified CNN-based image segmentation network that utilizes a deep generative model for data imputation. We train this model on normal CXRs with extensive data augmentation and demonstrate the usefulness of this model to extend to cases with extreme abnormalities. 1", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "Acute respiratory distress syndrome (ARDS) is characterized by rapid onset of inflammation in the lungs resulting in acute lung injury (Ware & Matthay, 2000) . The extent of lung infection is often used as a marker for measuring the disease severity.", "cite_spans": [{"start": 135, "end": 157, "text": "(Ware & Matthay, 2000)", "ref_id": "BIBREF28"}], "ref_spans": [], "section": "Introduction"}, {"text": "Imaging techniques are routinely employed to measure volume of lung infection due to ARDS (Bordley et al., 2004) ; this has also been attempted in detection of COVID-19 (Wong et al., 2020; Shi et al., 2020; Cohen et al., 2020) . As chest X-rays (CXRs) are easier to obtain than computed tomography (CT) scans, they are more regularly used to perform early stage triaging of patients with ARDS and currently with COVID-19 symptoms. Obtaining accurate segmentation of lung fields from CXRs is an essential first step in this process. However, extreme levels of opacification obfuscate large regions in the lungs making even manual Figure 1 . a) Normal chest X-ray showing the lungs clearly b) Abnormal CXR with high opacity where the right lung is hardly seen. Brighter regions are tissue-like as they attenuate X-rays whereas darker regions indicate presence of air, in this case inside the lungs. segmentation of lungs difficult (Jacobi et al., 2020) .", "cite_spans": [{"start": 90, "end": 112, "text": "(Bordley et al., 2004)", "ref_id": "BIBREF0"}, {"start": 169, "end": 188, "text": "(Wong et al., 2020;", "ref_id": "BIBREF30"}, {"start": 189, "end": 206, "text": "Shi et al., 2020;", "ref_id": "BIBREF22"}, {"start": 207, "end": 226, "text": "Cohen et al., 2020)", "ref_id": "BIBREF2"}, {"start": 929, "end": 950, "text": "(Jacobi et al., 2020)", "ref_id": "BIBREF10"}], "ref_spans": [{"start": 629, "end": 637, "text": "Figure 1", "ref_id": null}], "section": "Introduction"}, {"text": "Prior to deep learning, automatic segmentation of lungs from CXRs was primarily based on active shape analysis (Xu et al., 2012) and deformable models (Candemir et al., 2013) . With the advancement of fully convolutional neural (FCN) networks, CNN based methods have become state-of-the-art in various medical imaging tasks, including in lung segmentation tasks (Long et al., 2015; Ronneberger et al., 2015; Shin et al., 2016) . However, most of these methods operate based on a strong (and commonly used) assumption that the out-ofsample/test data points are also from the same distribution as the training set (Wen et al., 2014) . As a consequence, in lung segmentation tasks, segmentation models trained on CXRs with low opacification could fail to segment abnormal CXRs as their features can be vastly different as seen in Figure 1 .", "cite_spans": [{"start": 111, "end": 128, "text": "(Xu et al., 2012)", "ref_id": "BIBREF31"}, {"start": 151, "end": 174, "text": "(Candemir et al., 2013)", "ref_id": "BIBREF1"}, {"start": 362, "end": 381, "text": "(Long et al., 2015;", "ref_id": "BIBREF15"}, {"start": 382, "end": 407, "text": "Ronneberger et al., 2015;", "ref_id": null}, {"start": 408, "end": 426, "text": "Shin et al., 2016)", "ref_id": "BIBREF23"}, {"start": 612, "end": 630, "text": "(Wen et al., 2014)", "ref_id": "BIBREF29"}], "ref_spans": [{"start": 827, "end": 835, "text": "Figure 1", "ref_id": null}], "section": "Introduction"}, {"text": "Two recent methods have focused on segmenting lungs from high opacity CXRs, to the best of our knowledge (Souza et al., 2019; Tang et al., 2019) . In (Souza et al., 2019) , initial segmentations are obtained from a patch classification network and refined further using a reconstruction network. However, this method requires a reasonable amount of labeled examples for the abnormal cases. In (Tang et al., 2019) , the authors build on the capability of deep generative models to obtain realistic synthetic abnormal CXRs using adversarial training (Dai et al., 2018) and use these synthetic scans to train their segmentation model. This is a form of data augmentation, and it can also be limiting as the diversity of opacifications that can be realized using adversarial training are largely decided by the training samples.", "cite_spans": [{"start": 105, "end": 125, "text": "(Souza et al., 2019;", "ref_id": "BIBREF25"}, {"start": 126, "end": 144, "text": "Tang et al., 2019)", "ref_id": "BIBREF26"}, {"start": 150, "end": 170, "text": "(Souza et al., 2019)", "ref_id": "BIBREF25"}, {"start": 393, "end": 412, "text": "(Tang et al., 2019)", "ref_id": "BIBREF26"}, {"start": 548, "end": 566, "text": "(Dai et al., 2018)", "ref_id": "BIBREF3"}], "ref_spans": [], "section": "Introduction"}, {"text": "In this work, we aim to segment high opacity CXRs at test time by training primarily on normal CXRs. We treat this setting as dealing with incomplete data, as the training arXiv:2005.10052v1 [eess.IV] 20 May 2020 Figure 2 . Overview of the proposed model with a variational encoder for data imputation, V \u03c6 (\u00b7) and a U-net type segmentation network with encoder E \u03b8 (\u00b7) and decoder D \u03c8 (\u00b7) (highlighted inside the grey box). The decoder is shared between the data imputation block and the segmentation network. set does not contain high opacity images. Further, the opacification in CXRs itself is treated as the missing data that is to be inferred ( Figure 1 ). While we also rely on specialized data augmentation similar to (Tang et al., 2019) , presented in Section 2.2, we take up an alternative approach that builds on the strengths of deep latent variable generative models such as variational autoencoders (Kingma & Welling, 2014) . We add a variational encoder to impute data by concatenating samples from the learnt latent space to a standard CNN based segmentation network, which is then jointly decoded to obtain the segmentations. We demonstrate the usefulness of the proposed approach by training on labeled examples of normal CXRs and testing on extreme cases of opacification.", "cite_spans": [{"start": 726, "end": 745, "text": "(Tang et al., 2019)", "ref_id": "BIBREF26"}, {"start": 913, "end": 937, "text": "(Kingma & Welling, 2014)", "ref_id": "BIBREF13"}], "ref_spans": [{"start": 213, "end": 221, "text": "Figure 2", "ref_id": null}, {"start": 651, "end": 659, "text": "Figure 1", "ref_id": null}], "section": "Introduction"}, {"text": "Consider input images x \u2208 X and their corresponding segmentations s \u2208 S, then the task of supervised image segmentation can be formulated as obtaining a mapping f (\u00b7) : X \u2192 S.", "cite_spans": [], "ref_spans": [], "section": "Methods"}, {"text": "For a U-net type model (Ronneberger et al., 2015) the mapping function is composed of an encoder and decoder, such that f (\u00b7) = E \u03b8 (D \u03c8 (\u00b7)) where E \u03b8 , D \u03c8 are encoder and decoder neural networks parameterised by \u03b8 and \u03c8 respectively, as shown in Figure 2 .", "cite_spans": [{"start": 23, "end": 49, "text": "(Ronneberger et al., 2015)", "ref_id": null}], "ref_spans": [{"start": 249, "end": 257, "text": "Figure 2", "ref_id": null}], "section": "Methods"}, {"text": "Variational autoencoders have been used widely in generative settings as they can capture rich latent representations, which also make them a good fit for performing data imputation (Nazabal et al., 2018; Ham et al.) . In the generative setting the optimization objective of a VAE is the evidence lower bound (ELBO) given by", "cite_spans": [{"start": 182, "end": 204, "text": "(Nazabal et al., 2018;", "ref_id": "BIBREF17"}, {"start": 205, "end": 216, "text": "Ham et al.)", "ref_id": null}], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "where the first term, interpreted as reconstruction loss, is the negative expected log likelihood,", "cite_spans": [], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "wherex is the reconstructed input. The second term is the KL divergence between the approximating variational density q \u03c6 (z|x) = N (z; \u00b5 \u03c6 , \u03c3 2 \u03c6 ) with the standard normal prior on the latent variable p(z) = N (z;0,1). The parameters of the axis aligned Gaussian (\u00b5 \u03c6 ,\u03c3 2 \u03c6 ) are predicted by the encoder neural network V \u03c6 (\u00b7) with parameters \u03c6.", "cite_spans": [], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "In this work, the VAE is not used as an autoencoder but as a method to perform cross-domain mapping between the input X and the target segmentation S domains. This is in contrast with (Myronenko, 2018) , where the VAE was used to reconstruct the input image to have a regularizing effect on the encoder layers. The proposed use of VAE bears similarities with the non-adversarial domain mapping work such as in (Hoshen & Wolf, 2018; Hoshen, 2018) .", "cite_spans": [{"start": 184, "end": 201, "text": "(Myronenko, 2018)", "ref_id": "BIBREF16"}, {"start": 410, "end": 431, "text": "(Hoshen & Wolf, 2018;", "ref_id": "BIBREF8"}, {"start": 432, "end": 445, "text": "Hoshen, 2018)", "ref_id": "BIBREF7"}], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "We introduce the latent random variable z to obtain low dimensional representations of the data, x. We train the model with different augmentation strategies (Sec. 2.2) to learn a latent representation that can perform data imputation, handle missing data and possibly capture other task specific features such as shape information (Esser et al., 2018) .", "cite_spans": [{"start": 332, "end": 352, "text": "(Esser et al., 2018)", "ref_id": "BIBREF5"}], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "As depicted in Figure 2 , the variational encoder, V \u03c6 (\u00b7), maps input images to a low dimensional latent space and samples from the latent space are concatenated to the output of the encoder of the segmentation network, E \u03b8 (\u00b7), depicted in Fig. 2 . The decoder D \u03c8 (\u00b7) is shared between the U-net and the VAE such that they can jointly decode the segmentation s, resulting in the following objective (Hoshen, 2018) :", "cite_spans": [{"start": 402, "end": 416, "text": "(Hoshen, 2018)", "ref_id": "BIBREF7"}], "ref_spans": [{"start": 15, "end": 23, "text": "Figure 2", "ref_id": null}, {"start": 242, "end": 248, "text": "Fig. 2", "ref_id": null}], "section": "Variational Data Imputation"}, {"text": "where the predicted segmentation,\u015d, is obtained from the decoder:\u015d", "cite_spans": [], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "where \u2021 is used to indicate concatenation, h = E \u03b8 (x) is the output of the U-net encoder and z \u223c q \u03c6 (z|x) is a sample from the latent space learnt by the variational encoder. Note that the objective in Eq. (3) is similar to the ELBO objective in Eq. (1) except for the reconstruction loss, which is the standard segmentation loss computed between\u015d, the predicted segmentation and s, the target segmentation. As the segmentation masks are binary we use binary cross entropy loss as the reconstruction loss. A reasonable interpretation of the objective in Eq.", "cite_spans": [], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "(3) is that the first term helps in segmentation while the second term has a regularisation effect (Kingma & Welling, 2014; Myronenko, 2018 ) and helps with data imputation.", "cite_spans": [{"start": 99, "end": 123, "text": "(Kingma & Welling, 2014;", "ref_id": "BIBREF13"}, {"start": 124, "end": 139, "text": "Myronenko, 2018", "ref_id": "BIBREF16"}], "ref_spans": [], "section": "Variational Data Imputation"}, {"text": "Data augmentation strategies are now common practice when training deep learning models. They are primarily used to alleviate overfitting when labeled examples are scarce (Shorten & Khoshgoftaar, 2019) . In self-supervised learning, data augmentation techniques are utilised to uncover expressive latent representations that could be useful in downstream tasks (Kolesnikov et al., 2019) .", "cite_spans": [{"start": 171, "end": 201, "text": "(Shorten & Khoshgoftaar, 2019)", "ref_id": "BIBREF24"}, {"start": 361, "end": 386, "text": "(Kolesnikov et al., 2019)", "ref_id": "BIBREF14"}], "ref_spans": [], "section": "Augmentation strategies"}, {"text": "We use data augmentation extensively in this work. This is to simulate missing data instances such that the variational data imputation block can learn robust latent representations that can generalize well enough to high opacity CXRs at test time. We experiment with three types of data augmentations: 1) Standard 2) Block masking 3) Diffused noise.", "cite_spans": [], "ref_spans": [], "section": "Augmentation strategies"}, {"text": "The standard augmentation techniques used are random rotations, random horizontal and vertical flips. The block masking technique simply leaves out one half of the input image either horizontally or vertically ( Fig. 3-b) . Block masking simulates extreme opacifications where either entire lungs or large portions of it are missing due to opacification. This is similar to the class of random erasing techniques have been found to be useful in other image analysis tasks (Zhong et al., 2017) . Finally, the diffused noise model is task specific to segmenting the high opacity in CXRs. We utilize a Strauss process realization (Descombes & Zerubia, 2002) to obtain random sets of disks of varying radii allowing overlap, and smoothen them with a Gaussian kernel. This noise is then added to saturate the intensity values to reflect higher opacity (Fig. 3-c) . All augmentations are performed with a probability p aug . Additional visualizations of augmented input data are shown in Section 6.2 in the Appendix.", "cite_spans": [{"start": 472, "end": 492, "text": "(Zhong et al., 2017)", "ref_id": "BIBREF32"}, {"start": 627, "end": 654, "text": "(Descombes & Zerubia, 2002)", "ref_id": "BIBREF4"}], "ref_spans": [{"start": 212, "end": 221, "text": "Fig. 3-b)", "ref_id": "FIGREF0"}, {"start": 847, "end": 857, "text": "(Fig. 3-c)", "ref_id": "FIGREF0"}], "section": "Augmentation strategies"}, {"text": "We use publicly available CXR datasets with lung masks -from Shenzhen and Montgomery hospitals -curated for tuberculosis detection (Jaeger et al., 2014) 2 . We use 528 CXRs for training and 176 for validation purposes. These datasets do not contain extreme opacification (Fig. 3-a) when compared to cases with opacification ( Fig. 3-d) . We pool 30 diverse CXRs with high opacification to create a test set from different public repositories being curated in response to developing methods useful in detecting COVID-19 (Cohen et al., 2020; Pereira et al., 2020 ) and a relevant pneumonia detection dataset (Irvin et al., 2019) . As these test set images did not have lung masks, we obtained lung masks from expert annotators which are used to validate the proposed method.", "cite_spans": [{"start": 131, "end": 152, "text": "(Jaeger et al., 2014)", "ref_id": "BIBREF11"}, {"start": 519, "end": 539, "text": "(Cohen et al., 2020;", "ref_id": "BIBREF2"}, {"start": 540, "end": 560, "text": "Pereira et al., 2020", "ref_id": "BIBREF19"}, {"start": 606, "end": 626, "text": "(Irvin et al., 2019)", "ref_id": "BIBREF9"}], "ref_spans": [{"start": 271, "end": 281, "text": "(Fig. 3-a)", "ref_id": "FIGREF0"}, {"start": 326, "end": 335, "text": "Fig. 3-d)", "ref_id": "FIGREF0"}], "section": "Data and Experiments"}, {"text": "We use a U-net (Ronneberger et al., 2015) with modifications as the baseline method which operates at four resolutions, kernel size 3 and has an initial feature map of 24 which are doubled with each of the four downsampling operations.", "cite_spans": [{"start": 15, "end": 41, "text": "(Ronneberger et al., 2015)", "ref_id": null}], "ref_spans": [], "section": "Data and Experiments"}, {"text": "To increase the receptive field of the U-net, the first two resolutions are obtained with a scaling factor of 4 and the other two by a factor of 2. The modifications were based on experiments on the training data where we found increasing the receptive field to be beneficial.", "cite_spans": [], "ref_spans": [], "section": "Data and Experiments"}, {"text": "The proposed model utilizes a segmentation network like in the baseline U-net, and an additional variational encoder for data imputation. The variational encoder uses an encoder similar to the one in the baseline model and also operates at four resolutions. The variational encoder also utilizes a sequence of 4 1-D convolution layers to transform the 2-D feature maps to predict \u00b5 \u03c6 ,\u03c3 2 \u03c6 of the variational density. We use a latent dimension of 8. As the proposed model has an additional encoder, we reduce the initial feature map to 16 when compared to 24 in the baseline to make the models comparable. This results in about 4.2M parameters for the baseline and about 3.3M parameters for the proposed model.", "cite_spans": [], "ref_spans": [], "section": "Data and Experiments"}, {"text": "Both models were developed in PyTorch (Paszke et al., 2019) , trained with a batch size of 12, learning rate of 10 \u22124 with Adam optimizer (Kingma & Ba, 2014) for a maximum of 200 epochs on Nvidia-TitanX GPU with 12 GB memory. Convergence was assumed when there was no improvement in validation loss for 20 consecutive epochs. Model with the minimum validation loss is used for testing. We use a high probability for performing data augmentation, p aug = 0.9. The average CO 2 footprint of developing and training the baseline and proposed models is estimated to be 7.3 kg or equivalently about 60 km traveled by a car, measured using the Carbontracker tool 3 .", "cite_spans": [{"start": 38, "end": 59, "text": "(Paszke et al., 2019)", "ref_id": "BIBREF18"}, {"start": 138, "end": 157, "text": "(Kingma & Ba, 2014)", "ref_id": null}], "ref_spans": [], "section": "Data and Experiments"}, {"text": "Pre-and Post-processing: All input images are all rescaled to 640x512 px and are histogram equalized to improve the contrast in the images. The predicted segmentations are post-processed with connected component analysis to exclude small erroneous regions and binary morphological closing is done to fill any small holes of radius upto 10 pixels in the segmentation. Example visualizations for these steps are shown in Figures 6 and 7 included in the Appendix.", "cite_spans": [], "ref_spans": [{"start": 419, "end": 434, "text": "Figures 6 and 7", "ref_id": "FIGREF3"}], "section": "Data and Experiments"}, {"text": "We compare the baseline model with the proposed model with variational data imputation in several configurations by varying the data augmentation strategies discussed in . Box plot of test set performance for the baseline and proposed models using block masking and diffused noise data augmentations (last two rows of Table 1 ) Block+Diffuse 0.8148\u00b10.10 0.8101\u00b10.14 Proposed Block+Diffuse 0.8403 \u00b1 0.07 0.8248 \u00b1 0.14 Section 2.2. We measure the segmentation performance with two measures: dice overlap and binary accuracy. Results from these experiments are reported in Table 1 . Significant performance improvements, based on two-sided paired sample t-tests, when compared to all other configurations are highlighted in bold.", "cite_spans": [], "ref_spans": [{"start": 318, "end": 325, "text": "Table 1", "ref_id": "TABREF0"}, {"start": 570, "end": 577, "text": "Table 1", "ref_id": "TABREF0"}], "section": "Results and Discussions"}, {"text": "The best dice overlap (p < 0.05) and binary accuracy (p < 0.001) is obtained by the proposed model with variational data imputation when augmented with block masking and diffused noise, reported in the last row of Table 1 . Box plots with performance measures comprising all 30 test set images for the two models used with block masking and diffused noise augmentations are shown in Figure 4 . Predicted segmentations for three test set images are visualized in Figure 5 along with the ground truth annotations.", "cite_spans": [], "ref_spans": [{"start": 214, "end": 221, "text": "Table 1", "ref_id": "TABREF0"}, {"start": 383, "end": 391, "text": "Figure 4", "ref_id": "FIGREF1"}, {"start": 462, "end": 470, "text": "Figure 5", "ref_id": "FIGREF2"}], "section": "Results and Discussions"}, {"text": "The reported numbers in Table 1 indicate the usefulness of using data augmentation and the use of variational data imputation in a consistent manner. We observe improvements in performance of the baseline model with increasing complexity of data augmentations, in the order listed in Table 1 . With standard augmentation the baseline model obtains a dice accuracy of 0.7201 which improves to 0.8148 when using the block masking and diffused noise based augmentations. This trend is also noticed for the proposed model which shows a dice overlap improvement from 0.7266 to 0.8403.", "cite_spans": [], "ref_spans": [{"start": 24, "end": 31, "text": "Table 1", "ref_id": "TABREF0"}, {"start": 284, "end": 291, "text": "Table 1", "ref_id": "TABREF0"}], "section": "Results and Discussions"}, {"text": "Further, the proposed model with variational data imputation shows improvements within each data augmentation category when compared to the baseline method. The lowest p-value was obtained with the block masking and diffused noise reported in the last two rows. This aligns with the hypothesis that the variational data imputation is more effective in learning representations that can handle missing data. The stochastic variational block can be thought of as a data dependent noise model that perturbs the learnt feature maps of the U-net encoder, making it robust to missing data, similar to denoising auto-encoders which inject noise to the data to learn useful representations (Vincent et al., 2008) .", "cite_spans": [{"start": 682, "end": 704, "text": "(Vincent et al., 2008)", "ref_id": "BIBREF27"}], "ref_spans": [], "section": "Results and Discussions"}, {"text": "The qualitative examples shown in Figure 5 show the proposed model is able to output more complete segmentations when compared to the baseline. The predictions in second row show a case of incomplete segmentation predicted by the proposed model for a case with severe opacity. However, the shape of the lungs in this prediction is largely correct when compared to the baseline. This is another consequence of using the variational latent representation as it could help to learn useful features of the desired outputs, which in this case is to predict shapes that are close to lungs. This can also be interpreted as a form of shape regularisation (Esser et al., 2018) .", "cite_spans": [{"start": 647, "end": 667, "text": "(Esser et al., 2018)", "ref_id": "BIBREF5"}], "ref_spans": [{"start": 34, "end": 42, "text": "Figure 5", "ref_id": "FIGREF2"}], "section": "Results and Discussions"}, {"text": "Several high quality datasets comprising normal CXRs with expert segmentations are publicly available to train segmentation models. However, models trained solely on these data do not generalize well when new data with diverse variations, either due to acquisition or disease, are encountered. We treat such variations as instances of incomplete data and proposed to impute such missing information using the latent representations obtained using a variational encoder. The quality of the segmentations obtained with this method has been judged to be sufficient and we aim to use them to score COVID-19 risk from CXRs. ", "cite_spans": [], "ref_spans": [], "section": "Conclusions"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "Diagnosis and testing in bronchiolitis: a systematic review", "authors": [{"first": "W", "middle": ["C"], "last": "Bordley", "suffix": ""}, {"first": "M", "middle": [], "last": "Viswanathan", "suffix": ""}, {"first": "V", "middle": ["J"], "last": "King", "suffix": ""}, {"first": "S", "middle": ["F"], "last": "Sutton", "suffix": ""}, {"first": "A", "middle": ["M"], "last": "Jackman", "suffix": ""}, {"first": "L", "middle": [], "last": "Sterling", "suffix": ""}, {"first": "K", "middle": ["N"], "last": "Lohr", "suffix": ""}], "year": 2004, "venue": "Archives of pediatrics & adolescent medicine", "volume": "158", "issn": "2", "pages": "119--126", "other_ids": {}}, "BIBREF1": {"ref_id": "b1", "title": "Lung segmentation in chest radiographs using anatomical atlases with nonrigid registration", "authors": [{"first": "S", "middle": [], "last": "Candemir", "suffix": ""}, {"first": "S", "middle": [], "last": "Jaeger", "suffix": ""}, {"first": "K", "middle": [], "last": "Palaniappan", "suffix": ""}, {"first": "J", "middle": ["P"], "last": "Musco", "suffix": ""}, {"first": "R", "middle": ["K"], "last": "Singh", "suffix": ""}, {"first": "Z", "middle": [], "last": "Xue", "suffix": ""}, {"first": "A", "middle": [], "last": "Karargyris", "suffix": ""}, {"first": "S", "middle": [], "last": "Antani", "suffix": ""}, {"first": "G", "middle": [], "last": "Thoma", "suffix": ""}, {"first": "C", "middle": ["J"], "last": "Mcdonald", "suffix": ""}], "year": 2013, "venue": "IEEE transactions on medical imaging", "volume": "33", "issn": "2", "pages": "577--590", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "Covid-19 image data collection", "authors": [{"first": "J", "middle": ["P"], "last": "Cohen", "suffix": ""}, {"first": "P", "middle": [], "last": "Morrison", "suffix": ""}, {"first": "L", "middle": [], "last": "Dao", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:2003.11597"]}}, "BIBREF3": {"ref_id": "b3", "title": "Structure correcting adversarial network for chest x-rays organ segmentation", "authors": [{"first": "W", "middle": [], "last": "Dai", "suffix": ""}, {"first": "X", "middle": [], "last": "Liang", "suffix": ""}, {"first": "H", "middle": [], "last": "Zhang", "suffix": ""}, {"first": "E", "middle": [], "last": "Xing", "suffix": ""}, {"first": "Doyle", "middle": [], "last": "", "suffix": ""}, {"first": "J", "middle": [], "last": "", "suffix": ""}], "year": 2018, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "Marked point process in image analysis", "authors": [{"first": "X", "middle": [], "last": "Descombes", "suffix": ""}, {"first": "J", "middle": [], "last": "Zerubia", "suffix": ""}], "year": 2002, "venue": "IEEE Signal Processing Magazine", "volume": "19", "issn": "5", "pages": "77--84", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "A variational U-net for conditional appearance and shape generation", "authors": [{"first": "P", "middle": [], "last": "Esser", "suffix": ""}, {"first": "E", "middle": [], "last": "Sutter", "suffix": ""}, {"first": "B", "middle": [], "last": "Ommer", "suffix": ""}], "year": 2018, "venue": "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition", "volume": "", "issn": "", "pages": "8857--8866", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "Non-adversarial mapping with VAEs", "authors": [{"first": "Y", "middle": [], "last": "Hoshen", "suffix": ""}], "year": 2018, "venue": "Advances in Neural Information Processing Systems", "volume": "", "issn": "", "pages": "7528--7537", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Nam: Non-adversarial unsupervised domain mapping", "authors": [{"first": "Y", "middle": [], "last": "Hoshen", "suffix": ""}, {"first": "L", "middle": [], "last": "Wolf", "suffix": ""}], "year": 2018, "venue": "Proceedings of the European Conference on Computer Vision (ECCV)", "volume": "", "issn": "", "pages": "436--451", "other_ids": {}}, "BIBREF9": {"ref_id": "b9", "title": "Chexpert: A large chest radiograph dataset with uncertainty labels and expert comparison", "authors": [{"first": "J", "middle": [], "last": "Irvin", "suffix": ""}, {"first": "P", "middle": [], "last": "Rajpurkar", "suffix": ""}, {"first": "M", "middle": [], "last": "Ko", "suffix": ""}, {"first": "Y", "middle": [], "last": "Yu", "suffix": ""}, {"first": "S", "middle": [], "last": "Ciurea-Ilcus", "suffix": ""}, {"first": "C", "middle": [], "last": "Chute", "suffix": ""}, {"first": "H", "middle": [], "last": "Marklund", "suffix": ""}, {"first": "B", "middle": [], "last": "Haghgoo", "suffix": ""}, {"first": "R", "middle": [], "last": "Ball", "suffix": ""}, {"first": "K", "middle": [], "last": "Shpanskaya", "suffix": ""}], "year": 2019, "venue": "Proceedings of the AAAI Conference on Artificial Intelligence", "volume": "33", "issn": "", "pages": "590--597", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "Portable chest x-ray in coronavirus disease-19 (covid-19): A pictorial review", "authors": [{"first": "A", "middle": [], "last": "Jacobi", "suffix": ""}, {"first": "M", "middle": [], "last": "Chung", "suffix": ""}, {"first": "A", "middle": [], "last": "Bernheim", "suffix": ""}, {"first": "C", "middle": [], "last": "Eber", "suffix": ""}], "year": 2020, "venue": "Clinical Imaging", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Two public chest x-ray datasets for computer-aided screening of pulmonary diseases. Quantitative imaging in medicine and surgery", "authors": [{"first": "S", "middle": [], "last": "Jaeger", "suffix": ""}, {"first": "S", "middle": [], "last": "Candemir", "suffix": ""}, {"first": "S", "middle": [], "last": "Antani", "suffix": ""}, {"first": "Y.-X", "middle": ["J"], "last": "W\u00e1ng", "suffix": ""}, {"first": "P.-X", "middle": [], "last": "Lu", "suffix": ""}, {"first": "G", "middle": [], "last": "Thoma", "suffix": ""}], "year": 2014, "venue": "", "volume": "4", "issn": "", "pages": "", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "Auto-encoding variational bayes", "authors": [{"first": "D", "middle": ["P"], "last": "Kingma", "suffix": ""}, {"first": "M", "middle": [], "last": "Welling", "suffix": ""}], "year": 2014, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "Revisiting selfsupervised visual representation learning", "authors": [{"first": "A", "middle": [], "last": "Kolesnikov", "suffix": ""}, {"first": "X", "middle": [], "last": "Zhai", "suffix": ""}, {"first": "L", "middle": [], "last": "Beyer", "suffix": ""}], "year": 2019, "venue": "Proceedings of the IEEE conference on Computer Vision and Pattern Recognition", "volume": "", "issn": "", "pages": "1920--1929", "other_ids": {}}, "BIBREF15": {"ref_id": "b15", "title": "Fully convolutional networks for semantic segmentation", "authors": [{"first": "J", "middle": [], "last": "Long", "suffix": ""}, {"first": "E", "middle": [], "last": "Shelhamer", "suffix": ""}, {"first": "Darrell", "middle": [], "last": "", "suffix": ""}, {"first": "T", "middle": [], "last": "", "suffix": ""}], "year": 2015, "venue": "Proceedings of the IEEE conference on computer vision and pattern recognition", "volume": "", "issn": "", "pages": "3431--3440", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "3d mri brain tumor segmentation using autoencoder regularization", "authors": [{"first": "A", "middle": [], "last": "Myronenko", "suffix": ""}], "year": 2018, "venue": "International MICCAI Brainlesion Workshop", "volume": "", "issn": "", "pages": "311--320", "other_ids": {}}, "BIBREF17": {"ref_id": "b17", "title": "Handling incomplete heterogeneous data using vaes", "authors": [{"first": "A", "middle": [], "last": "Nazabal", "suffix": ""}, {"first": "P", "middle": ["M"], "last": "Olmos", "suffix": ""}, {"first": "Z", "middle": [], "last": "Ghahramani", "suffix": ""}, {"first": "I", "middle": [], "last": "Valera", "suffix": ""}], "year": 2018, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1807.03653"]}}, "BIBREF18": {"ref_id": "b18", "title": "Pytorch: An imperative style, high-performance deep learning library", "authors": [{"first": "A", "middle": [], "last": "Paszke", "suffix": ""}, {"first": "S", "middle": [], "last": "Gross", "suffix": ""}, {"first": "F", "middle": [], "last": "Massa", "suffix": ""}, {"first": "A", "middle": [], "last": "Lerer", "suffix": ""}, {"first": "J", "middle": [], "last": "Bradbury", "suffix": ""}, {"first": "G", "middle": [], "last": "Chanan", "suffix": ""}, {"first": "T", "middle": [], "last": "Killeen", "suffix": ""}, {"first": "Z", "middle": [], "last": "Lin", "suffix": ""}, {"first": "N", "middle": [], "last": "Gimelshein", "suffix": ""}, {"first": "L", "middle": [], "last": "Antiga", "suffix": ""}], "year": 2019, "venue": "Advances in Neural Information Processing Systems", "volume": "", "issn": "", "pages": "8024--8035", "other_ids": {}}, "BIBREF19": {"ref_id": "b19", "title": "Covid-19 identification in chest x-ray images on flat and hierarchical classification scenarios", "authors": [{"first": "R", "middle": ["M"], "last": "Pereira", "suffix": ""}, {"first": "D", "middle": [], "last": "Bertolini", "suffix": ""}, {"first": "L", "middle": ["O"], "last": "Teixeira", "suffix": ""}, {"first": "C", "middle": ["N"], "last": "Silla", "suffix": ""}, {"first": "Y", "middle": ["M"], "last": "Costa", "suffix": ""}], "year": 2020, "venue": "Computer Methods and Programs in Biomedicine", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF20": {"ref_id": "b20", "title": "U-net: Convolutional networks for biomedical image segmentation", "authors": [{"first": "O", "middle": [], "last": "Ronneberger", "suffix": ""}, {"first": "P", "middle": [], "last": "Fischer", "suffix": ""}, {"first": "T", "middle": [], "last": "Brox", "suffix": ""}], "year": null, "venue": "International Conference on Medical image computing and computer-assisted intervention", "volume": "", "issn": "", "pages": "234--241", "other_ids": {}}, "BIBREF22": {"ref_id": "b22", "title": "Radiological findings from 81 patients with covid-19 pneumonia in wuhan, china: a descriptive study", "authors": [{"first": "H", "middle": [], "last": "Shi", "suffix": ""}, {"first": "X", "middle": [], "last": "Han", "suffix": ""}, {"first": "N", "middle": [], "last": "Jiang", "suffix": ""}, {"first": "Y", "middle": [], "last": "Cao", "suffix": ""}, {"first": "O", "middle": [], "last": "Alwalid", "suffix": ""}, {"first": "J", "middle": [], "last": "Gu", "suffix": ""}, {"first": "Y", "middle": [], "last": "Fan", "suffix": ""}, {"first": "C", "middle": [], "last": "Zheng", "suffix": ""}], "year": 2020, "venue": "The Lancet Infectious Diseases", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "Learning to read chest x-rays: Recurrent neural cascade model for automated image annotation", "authors": [{"first": "H.-C", "middle": [], "last": "Shin", "suffix": ""}, {"first": "K", "middle": [], "last": "Roberts", "suffix": ""}, {"first": "L", "middle": [], "last": "Lu", "suffix": ""}, {"first": "D", "middle": [], "last": "Demner-Fushman", "suffix": ""}, {"first": "J", "middle": [], "last": "Yao", "suffix": ""}, {"first": "R", "middle": ["M"], "last": "Summers", "suffix": ""}], "year": 2016, "venue": "Proceedings of the IEEE conference on computer vision and pattern recognition", "volume": "", "issn": "", "pages": "2497--2506", "other_ids": {}}, "BIBREF24": {"ref_id": "b24", "title": "A survey on image data augmentation for deep learning", "authors": [{"first": "C", "middle": [], "last": "Shorten", "suffix": ""}, {"first": "T", "middle": ["M"], "last": "Khoshgoftaar", "suffix": ""}], "year": 2019, "venue": "Journal of Big Data", "volume": "6", "issn": "1", "pages": "", "other_ids": {}}, "BIBREF25": {"ref_id": "b25", "title": "An automatic method for lung segmentation and reconstruction in chest X-ray using deep neural networks. Computer methods and programs in biomedicine", "authors": [{"first": "J", "middle": ["C"], "last": "Souza", "suffix": ""}, {"first": "J", "middle": ["O B"], "last": "Diniz", "suffix": ""}, {"first": "J", "middle": ["L"], "last": "Ferreira", "suffix": ""}, {"first": "G", "middle": ["L F"], "last": "Da Silva", "suffix": ""}, {"first": "A", "middle": ["C"], "last": "Silva", "suffix": ""}, {"first": "A", "middle": ["C"], "last": "De Paiva", "suffix": ""}], "year": 2019, "venue": "", "volume": "177", "issn": "", "pages": "285--296", "other_ids": {}}, "BIBREF26": {"ref_id": "b26", "title": "XLSor: A robust and accurate lung segmentor on chest X-rays using criss-cross attention and customized radiorealistic abnormalities generation", "authors": [{"first": "Y", "middle": [], "last": "Tang", "suffix": ""}, {"first": "Y", "middle": [], "last": "Tang", "suffix": ""}, {"first": "J", "middle": [], "last": "Xiao", "suffix": ""}, {"first": "R", "middle": ["M"], "last": "Summers", "suffix": ""}], "year": 2019, "venue": "International Conference on Medical Imaging with Deep Learning -Full Paper Track", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF27": {"ref_id": "b27", "title": "Extracting and composing robust features with denoising autoencoders", "authors": [{"first": "P", "middle": [], "last": "Vincent", "suffix": ""}, {"first": "H", "middle": [], "last": "Larochelle", "suffix": ""}, {"first": "Y", "middle": [], "last": "Bengio", "suffix": ""}, {"first": "P.-A", "middle": [], "last": "Manzagol", "suffix": ""}], "year": 2008, "venue": "Proceedings of the 25th international conference on Machine learning", "volume": "", "issn": "", "pages": "1096--1103", "other_ids": {}}, "BIBREF28": {"ref_id": "b28", "title": "The acute respiratory distress syndrome", "authors": [{"first": "L", "middle": ["B"], "last": "Ware", "suffix": ""}, {"first": "M", "middle": ["A"], "last": "Matthay", "suffix": ""}], "year": 2000, "venue": "New England Journal of Medicine", "volume": "342", "issn": "18", "pages": "1334--1349", "other_ids": {}}, "BIBREF29": {"ref_id": "b29", "title": "Robust learning under uncertain test distributions: Relating covariate shift to model misspecification", "authors": [{"first": "J", "middle": [], "last": "Wen", "suffix": ""}, {"first": "C.-N", "middle": [], "last": "Yu", "suffix": ""}, {"first": "R", "middle": [], "last": "Greiner", "suffix": ""}], "year": 2014, "venue": "ICML", "volume": "", "issn": "", "pages": "631--639", "other_ids": {}}, "BIBREF30": {"ref_id": "b30", "title": "Frequency and distribution of chest radiographic findings in covid-19 positive patients", "authors": [{"first": "H", "middle": ["Y F"], "last": "Wong", "suffix": ""}, {"first": "H", "middle": ["Y S"], "last": "Lam", "suffix": ""}, {"first": "A", "middle": ["H"], "last": "Fong", "suffix": ""}, {"first": ".-T", "middle": [], "last": "Leung", "suffix": ""}, {"first": "S", "middle": ["T"], "last": "Chin", "suffix": ""}, {"first": "T", "middle": ["W"], "last": "", "suffix": ""}, {"first": ".-Y", "middle": [], "last": "Lo", "suffix": ""}, {"first": "C", "middle": ["S Y"], "last": "Lui", "suffix": ""}, {"first": "M", "middle": ["M"], "last": "", "suffix": ""}, {"first": ".-S", "middle": [], "last": "Lee", "suffix": ""}, {"first": "J", "middle": ["C Y"], "last": "Chiu", "suffix": ""}, {"first": "K", "middle": ["W"], "last": "", "suffix": ""}, {"first": ".-H", "middle": [], "last": "Chung", "suffix": ""}, {"first": "T", "middle": [], "last": "", "suffix": ""}], "year": 2020, "venue": "Radiology", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF31": {"ref_id": "b31", "title": "An edge-region force guided active shape approach for automatic lung field detection in chest radiographs", "authors": [{"first": "T", "middle": [], "last": "Xu", "suffix": ""}, {"first": "M", "middle": [], "last": "Mandal", "suffix": ""}, {"first": "R", "middle": [], "last": "Long", "suffix": ""}, {"first": "I", "middle": [], "last": "Cheng", "suffix": ""}, {"first": "A", "middle": [], "last": "Basu", "suffix": ""}], "year": 2012, "venue": "Computerized Medical Imaging and Graphics", "volume": "36", "issn": "6", "pages": "452--463", "other_ids": {}}, "BIBREF32": {"ref_id": "b32", "title": "Random erasing data augmentation", "authors": [{"first": "Z", "middle": [], "last": "Zhong", "suffix": ""}, {"first": "L", "middle": [], "last": "Zheng", "suffix": ""}, {"first": "G", "middle": [], "last": "Kang", "suffix": ""}, {"first": "S", "middle": [], "last": "Li", "suffix": ""}, {"first": "Yang", "middle": [], "last": "", "suffix": ""}, {"first": "Y", "middle": [], "last": "", "suffix": ""}], "year": 2017, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1708.04896"]}}}, "ref_entries": {"FIGREF0": {"text": "Chest X-rays with and without augmentation. (a) No augmentation (b) With block masking (c) With diffused noise marked with red ellipses (d) Test image with high opacity", "latex": null, "type": "figure"}, "FIGREF1": {"text": "Figure 4. Box plot of test set performance for the baseline and proposed models using block masking and diffused noise data augmentations (last two rows of Table 1)", "latex": null, "type": "figure"}, "FIGREF2": {"text": "a) Three test set samples with highest and least dice accuracy for both methods (rows 1 & 2) along with an input CXR with additional variations in pose (row-3). b) baseline model predictions, c) proposed model predictions and d) the ground truth. Both predictions are for models trained with block and diffused noise. Green:True positive, Blue: False Negative, Red: False Positive.", "latex": null, "type": "figure"}, "FIGREF3": {"text": "Input images a) before and b) after histogram equalizationFigure 7. a) Input image b) Predicted segmentation overlaid with reference c) Post-processed prediction. Notice the removal of the false positive in the center and closing of a hole in the lower right lung.", "latex": null, "type": "figure"}, "FIGREF4": {"text": "Block masking augmentation", "latex": null, "type": "figure"}, "FIGREF5": {"text": "Diffused noise augmentation Block masking and diffused noise augmentation", "latex": null, "type": "figure"}, "TABREF0": {"text": "Performance measures on the test set", "latex": null, "type": "table"}, "TABREF1": {"text": "Table 1 )\nTable 1.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Models </td><td>Augmentation </td><td>Performance measures on the test set Dice Overlap </td><td>Accuracy\n</td></tr><tr><td>Baseline </td><td>Standard </td><td>0.7201\u00b10.14 </td><td>0.7871\u00b10.13\n</td></tr><tr><td>Proposed </td><td>Standard </td><td>0.7266\u00b10.15 </td><td>0.7875\u00b10.13\n</td></tr><tr><td>Baseline </td><td>Block </td><td>0.7652\u00b10.10 </td><td>0.7971\u00b10.14\n</td></tr><tr><td>Proposed </td><td>Block </td><td>0.7681\u00b10.10 </td><td>0.7959\u00b10.14\n</td></tr><tr><td>Baseline </td><td>Diffuse </td><td>0.7944\u00b10.09 </td><td>0.8102\u00b10.14\n</td></tr><tr><td>Proposed </td><td>Diffuse </td><td>0.7987\u00b10.11 </td><td>0.8140\u00b10.15\n</td></tr><tr><td>Baseline </td><td>Block+Diffuse </td><td>0.8148\u00b10.10 </td><td>0.8101\u00b10.14\n</td></tr><tr><td>Proposed </td><td>Block+Diffuse </td><td>0.8403 \u00b1 0.07 </td><td>0.8248 \u00b1 0.14\n</td></tr></table></body></html>"}}, "back_matter": [{"text": "The authors would like to thank Anna Zhigalova, Evelina Seduikyte and Joshua Szanyi for their effort in annotating the test set samples. We also thank Abraham Smith and Jens Petersen for useful discussions.", "cite_spans": [], "ref_spans": [], "section": "Acknowledgements"}]}